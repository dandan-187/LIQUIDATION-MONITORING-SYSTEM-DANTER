import React, { useState } from "react";
import { Button } from "@/components/ui/button";
import { Card, CardContent } from "@/components/ui/card";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Input } from "@/components/ui/input";
import { Plus } from "lucide-react";

const TravelLiquidation = () => {
  const [rows, setRows] = useState([
    { from: "", to: "", vehicle: "", amount: "" },
  ]);

  const addRow = () => {
    setRows([...rows, { from: "", to: "", vehicle: "", amount: "" }]);
  };

  const handleInputChange = (index, field, value) => {
    const newRows = [...rows];
    newRows[index][field] = value;
    setRows(newRows);
  };

  const calculateTotal = () => {
    const travelTotal = rows.reduce((sum, row) => sum + (Number(row.amount) || 0), 0);
    const mealTotal = 80;
    return { travelTotal, mealTotal, grandTotal: travelTotal + mealTotal };
  };

  const { travelTotal, mealTotal, grandTotal } = calculateTotal();

  return (
    <div className="flex flex-col items-center w-full p-4">
      <Card className="w-full max-w-sm p-4">
        <CardContent>
          <div className="flex flex-col gap-2">
            {rows.map((row, index) => (
              <div key={index} className="grid grid-cols-4 gap-2 items-center">
                <Input
                  placeholder="From"
                  value={row.from}
                  onChange={(e) => handleInputChange(index, "from", e.target.value)}
                />
                <Input
                  placeholder="To"
                  value={row.to}
                  onChange={(e) => handleInputChange(index, "to", e.target.value)}
                />
                <Select onValueChange={(value) => handleInputChange(index, "vehicle", value)}>
                  <SelectTrigger>
                    <SelectValue placeholder="ğŸš" />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="bus">ğŸšŒ</SelectItem>
                    <SelectItem value="tricycle">ğŸ›º</SelectItem>
                    <SelectItem value="taxi">ğŸš–</SelectItem>
                    <SelectItem value="jeep">ğŸš</SelectItem>
                    <SelectItem value="train">ğŸš†</SelectItem>
                  </SelectContent>
                </Select>
                <Input
                  type="number"
                  placeholder="â‚± Amount"
                  value={row.amount}
                  onChange={(e) => handleInputChange(index, "amount", e.target.value)}
                />
              </div>
            ))}
            <Button onClick={addRow} variant="outline" className="w-full mt-2">
              <Plus size={16} />
            </Button>
            <div className="mt-4 text-center text-lg">
              <p>ğŸš– Travel: â‚±{travelTotal}</p>
              <p>ğŸ½ï¸ Meal: â‚±{mealTotal}</p>
              <p className="font-bold">ğŸ’° Total: â‚±{grandTotal}</p>
            </div>
          </div>
        </CardContent>
      </Card>
    </div>
  );
};

export default TravelLiquidation;
